---
layout: post
title: string_view
date: 2019-11-08 17:45:20
description: string_view
tag: C_CPP

---

# string_view

- [string_view](#string_view)
  - [简介](#简介)
  - [参考资料](#参考资料)

## 简介

&emsp;&emsp;在日常C/C++编程中，我们常进行数据的传递操作，比如，将数据传给函数。当数据占用的内存较大时，减少数据的拷贝可以有效提高程序的性能。在C中指针是完成这一目的的标准数据结构，而C++引入了安全性更高的引用类型。所以在C++中若传递的数据仅仅只读，const string&成了C++的天然的方式。但这并非完美，从实践来看，它至少有以下几方面问题：

1. 字符串字面值、字符数组、字符串指针的传递仍要数据拷贝
这三类低级数据类型与string类型不同，传入时，编译器需要做隐式转换，即需要拷贝这些数据生成string临时对象。const string&指向的实际上是这个临时对象。通常字符串字面值较小，性能损耗可以忽略不计；但字符串指针和字符数组某些情况下可能会比较大（比如读取文件的内容），此时会引起频繁的内存分配和数据拷贝，会严重影响程序的性能。
2. substr O(n)复杂度
这是一个特别常用的函数，好在std::string提供了这个函数，美中不足的是其每次都返回一个新生成的子串，很容易引起性能热点。实际上我们本意并不是要改变原字符串，为什么不在原字符串基础上返回呢？

在C++17中引入了string_view，能很好的解决以上两个问题。

## 参考资料

1. [【现代C++】性能控的工具箱之string_view](https://segmentfault.com/a/1190000018387368)